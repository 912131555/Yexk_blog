{include file='public/header'}
<div class="row">
	<div class="col-md-12">

		<div class="panel panel-default">
			<div class="panel-heading"> <h3 class="panel-title">Table Styles</h3> </div>
			<div class="panel-body panel-border">
			<table class="table table-striped table-model-2 table-hover">
				<thead>
					<tr>
						<th>#ID</th>
						<th>分类名称</th>
						<th>分类描述</th>
						<th>上级id</th>
						<th>操作</th>
					</tr>
				</thead>
				
				<tbody>
					<?php foreach ($cate_list as $k => $v): ?>
					<tr>
						<td><?php echo $v['id'] ?></td>
						<td><?php echo str_repeat('&nbsp;',$v['level']*8) . $v['name'] ?></td>
						<td><?php echo $v['desc'] ?></td>
						<td><?php echo $v['pid'] ?></td>
						<td>
							<button class="btn btn-info" onclick="modify(<?php echo $v['id'] ?>)">修改</button>
							<button class="btn btn-warning" onclick="del(<?php echo $v['id'] ?>)">删除</button>
						</td>
					</tr>
					<?php endforeach ?>
				</tbody>
			</table>
			</div>
		</div>
	</div>
</div>


{include file='public/footer'}

<!-- Modify -->
<div class="modal fade" id="cate_modify">
	<div class="modal-dialog">
		<div class="modal-content">					
				<div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
			        <h4 class="modal-title">文章修改</h4>
		      	</div>
				<div class="modal-body">
					
				<form id="_cate_modify" role="form" method="POST" class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-2 control-label">文章分类</label>
						<div class="col-sm-10">
							<select class="form-control" name="pid" id="pid">
								<option value="0">顶级分类</option>
								<?php foreach ($cate_list as $k => $v): ?>
									<option value="<?php echo $v['id'] ?>"><?php echo str_repeat('&nbsp;',$v['level']*4) . $v['name'] ?></option>
								<?php endforeach ?>
							</select>
						</div>
					</div>
					<div class="form-group-separator"></div>
					
					<div class="form-group">
						<label class="col-sm-2 control-label" for="name">分类名称</label>
						<div class="col-sm-10">
							<input type="text" class="form-control" name="name" id="name" >
							<input type="hidden" id="id">
						</div>
					</div>
					<div class="form-group-separator"></div>

					<div class="form-group">
						<label class="col-sm-2 control-label" for="desc">分类描述</label>
						<div class="col-sm-10">
							<input type="text" class="form-control" name="desc" id="desc" >
						</div>
					</div>
					<div class="form-group-separator"></div>
					
					<div class="form-group">
					<div class="col-sm-10 col-sm-offset-2">
						<button type="submit" class="btn btn-info btn-single">提交修改</button>
					</div>
					</div>
					
				</form>
						
		</div>
	</div>
</div>

<script>
	// 修改
	function modify(id) {
		$.ajax({
			url: '{:url("admin/Category/read")}',
			type: 'POST',
			dataType: 'json',
			data: {'id':id},
			success:function(data){
				console.log(data);
				if (1 === data.code) {
					$('#id').val(data.data.id);
					$('#pid').val(data.data.pid);
					$('#name').val(data.data.name);
					$('#desc').val(data.data.desc);
					$('#cate_modify').modal('show');
				}
				else
				{
					alert('获取数据失败！');
				}
			}
		});
	}

	/**
	 * TODO 提交数据，删除，待完成
	 * @Author Yexk
	 * @Date   2016-12-05
	 */
	$('#_cate_modify').submit(function(event) {
		alert('提交')
		return false;
	});
	// 删除
	function del(id) {
		alert(id)
	}
</script>

